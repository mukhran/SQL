09/21

Unique Users Per Client Per Month id 2024

Write a query that returns the number of unique users per client per month (easy)

Table: fact_events

fact_events

id:
int
time_id:
datetime
user_id:
varchar
customer_id:
varchar
client_id:
varchar
event_type:
varchar
event_id:
int

select count(distinct user_id) as number_uniq, client_id, EXTRACT(month from time_id) as month
from fact_events
group by client_id, month


------------------------------------------------------------------------

First Name's Containing the Letter 'a'  easy

Find all workers whose first name contains the letter 'a'. Output all columns for such workers.

Table: worker

worker
Preview
worker_id:
int
first_name:
varchar
last_name:
varchar
salary:
int
joining_date:
datetime
department:
varchar

select *
from worker
where lower(first_name) LIKE '%a%'

------------------------------------------------------------------------


Submission Types (B) id2002  easy
Write a query that returns the user ID of all users that have created at least one ‘Refinance’ submission 
and at least one ‘InSchool’ submission.

Table: loans

id:
int
user_id:
int
created_at:
datetime
status:
varchar
type:
varchar

select user_id
from loans
where type IN ('Refinance','InSchool')
group by user_id
having count(distinct type) >=2



SELECT user_id
FROM loans
WHERE type = 'Refinance'
INTERSECT
SELECT user_id
FROM loans
WHERE type = 'InSchool'

------------------------------------------------------------------------


Find all companies with more than 10 employees  easy
google_adwords_earnings

Preview
business_type:
varchar
n_employees:
int
year:
int
adwords_earnings:
int

select *
from google_adwords_earnings
where n_employees > 10

------------------------------------------------------------------------

Number Of Bathrooms And Bedrooms easy

Find the average number of bathrooms and bedrooms for each city’s property types. 
Output the result along with the city name and the property type.

Table: airbnb_search_details

airbnb_search_details

Unnamed: 0: int
id: int
price: float
property_type:
varchar
room_type:
varchar
amenities:
varchar
accommodates:
int
bathrooms:
int
bed_type:
varchar
cancellation_policy:
varchar
cleaning_fee:
bool
city:
varchar
host_identity_verified:
varchar
host_response_rate:
varchar
host_since:
datetime
neighbourhood:
varchar
number_of_reviews:
int
review_scores_rating:
float
zipcode:
int
bedrooms:
int
beds:
int

select city, property_type, AVG(bathrooms) as avg_bathrooms, AVG(bedrooms) as avg_bedrooms
from airbnb_search_details
group by city, property_type

------------------------------------------------------------------------

Number of Shipments Per Month id2056 easy

Write a query that will calculate the number of shipments per month. 
The unique key for one shipment is a combination of shipment_id and sub_id. 
Output the year_month in format YYYY-MM and the number of shipments in that month.

postgresql

amazon_shipment

shipment_id:
int
sub_id:
int
weight:
int
shipment_date:
datetime


select to_char(shipment_date, 'YYYY-MM') AS year_month,
       count(distinct (shipment_id, sub_id))
from amazon_shipment
group by year_month




------------------------------------------------------------------------


09/22 

Employees With First Names 'Vipul' or 'Satish' or Last Name Containing a 'c'

Employees Without First Names 'Vipul' or 'Satish' or Last Name Containing a 'c'


worker
Preview
worker_id:
int
first_name:
varchar
last_name:
varchar
salary:
int
joining_date:
datetime
department:
varchar

select *
from worker
WHERE first_name in ('Vipul','Satish') or lower(last_name) LIKE '%c%'

select *
from worker
WHERE first_name not in ('Vipul','Satish') and lower(last_name) NOT LIKE '%c%'

------------------------------------------------------------------------

Find all athletes who were older than 40 years when they won either Bronze or Silver medals

olympics_athletes_events
Preview
id:
int
name:
varchar
sex:
varchar
age:
float
height:
float
weight:
datetime
team:
varchar
noc:
varchar
games:
varchar
year:
int
season:
varchar
city:
varchar
sport:
varchar
event:
varchar
medal:
varchar

select name
from olympics_athletes_events
WHERE age > 40 and medal IN ('Bronze', 'Silver')

------------------------------------------------------------------------


Find all facilities with the zip code 90049, 90034, or 90045.

los_angeles_restaurant_health_inspections
Preview
serial_number:
varchar
activity_date:
datetime
facility_name:
varchar
score:
int
grade:
varchar
service_code:
int
service_description:
varchar
employee_id:
varchar
facility_address:
varchar
facility_city:
varchar
facility_id:
varchar
facility_state:
varchar
facility_zip:
varchar
owner_id:
varchar
owner_name:
varchar
pe_description:
varchar
program_element_pe:
int
program_name:
varchar
program_status:
varchar
record_id:
varcha

select DISTINCT(facility_name)
from los_angeles_restaurant_health_inspections
where facility_zip IN ('90049','90034','90045')

------------------------------------------------------------------------


